<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="generator" content="ApiGen 2.8.0" />

	<title>Class CPersistentObject | MyWrapper Reference Documentation</title>

	<script type="text/javascript" src="resources/combined.js?368249000"></script>
	<script type="text/javascript" src="elementlist.js?1653466708"></script>
	<link rel="stylesheet" type="text/css" media="all" href="resources/style.css?3505392360" />

</head>

<body>
<div id="left">
	<div id="menu">
		<a href="index.html" title="Overview"><span>Overview</span></a>


		<div id="groups">
			<h3>Packages</h3>
			<ul>
				<li class="active main"><a href="package-MyWrapper.html">MyWrapper<span></span></a>
						<ul>
				<li class="main"><a href="package-MyWrapper.Data.html">Data</a>
						</li>
				<li class="main"><a href="package-MyWrapper.Definitions.html">Definitions</a>
						</li>
				<li class="main"><a href="package-MyWrapper.Framework.html">Framework</a>
						</li>
				<li class="main"><a href="package-MyWrapper.Functions.html">Functions</a>
						</li>
				<li class="main"><a href="package-MyWrapper.Ontology.html">Ontology</a>
						</li>
				<li class="active main"><a href="package-MyWrapper.Persistence.html">Persistence</a>
						</li>
				<li class="main"><a href="package-MyWrapper.Wrappers.html">Wrappers</a>
						</li>
							</ul></li>
				<li><a href="package-PHP.html">PHP</a>
						</li>
			</ul>
		</div>

		<hr />


		<div id="elements">
			<h3>Classes</h3>
			<ul>
				<li><a href="class-CMongoContainer.html">CMongoContainer</a></li>
				<li><a href="class-CMongoDatabase.html">CMongoDatabase</a></li>
				<li><a href="class-CMongoQuery.html">CMongoQuery</a></li>
				<li><a href="class-CMongoServer.html">CMongoServer</a></li>
				<li><a href="class-CPersistentDocument.html">CPersistentDocument</a></li>
				<li class="active"><a href="class-CPersistentObject.html">CPersistentObject</a></li>
			</ul>





		</div>
	</div>
</div>

<div id="splitter"></div>

<div id="right">
<div id="rightInner">
	<form id="search">
		<input type="hidden" name="cx" value="" />
		<input type="hidden" name="ie" value="UTF-8" />
		<input type="text" name="q" class="text" />
		<input type="submit" value="Search" />
	</form>

	<div id="navigation">
		<ul>
			<li>
				<a href="index.html" title="Overview"><span>Overview</span></a>
			</li>
			<li>
				<a href="package-MyWrapper.Persistence.html" title="Summary of MyWrapper\Persistence"><span>Package</span></a>
			</li>
			<li class="active">
<span>Class</span>			</li>
		</ul>
		<ul>
			<li>
				<a href="tree.html" title="Tree view of classes, interfaces, traits and exceptions"><span>Tree</span></a>
			</li>
		</ul>
		<ul>
		</ul>
	</div>

<div id="content" class="class">
	<h1>Class CPersistentObject</h1>


	<div class="description">
	
<h3>Persistent object ancestor</h3>

<p>This <i>abstract</i> class extends its <code><a href="class-CPersistentDocument.html">CPersistentDocument</a></code> ancestor
to implement an identification interface that governs how objects derived from
this class are identified within their container.</p>

<p>The object is uniquely identified by a string, the <i>global unique
identifier</i>, this string is generally a combination of the object's
attributes and once set, it should not change. The string is composed by a
protected method, <code><a href="class-CPersistentObject.html#__index">CPersistentObject::_index()</a></code>, and set into a predefined offset, kTAG_GID.</p>

<p>This value will be used to generate the <i>native unique identifier</i>,
kOFFSET_NID, which represents the object's primary key within the
container in which it is stored. The value is obtained by feeding the kTAG_GID to a static method, <code><a href="class-CPersistentObject.html#__id">CPersistentObject::_id()</a></code>, whose function is to transform the
provided value into one optimised as a primary key. The method is static so that
any global identifier can be converted into a native one.</p>

<p>Once the object has been committed, these identifiers are locked by the
<code><a href="class-CPersistentObject.html#__Preset">CPersistentObject::_Preset()</a></code> and <code><a href="class-CPersistentObject.html#__Preunset">CPersistentObject::_Preunset()</a></code> methods to prevent invalidating object
references.</p>

<p>The class features a predefined offset, kTAG_CLASS, that receives the
class name of the object: this value will be used by the static <code><a href="class-CPersistentObject.html#_NewObject">CPersistentObject::NewObject()</a></code> method to instantiate the correct object.</p>

<p>All objects derived from this class should implement the <code><a href="class-CPersistentObject.html#___toString">CPersistentObject::__toString()</a></code>
method, by default this class returns the global identifier, kTAG_GID.
Derived classes may change this behaviour, in particular when the class does not
feature the global identifier: the important thing is to be able to cast an
object to a string.</p>

<p>Finally, the class features member accessor methods for the default
offsets:</p>

<ul>
	<li><code><a href="class-CPersistentObject.html#_GID">CPersistentObject::GID()</a></code>: This method manages the global unique identifier, kTAG_GID.</li>

	<li>ClassName(): This method manages the object's class name, kTAG_CLASS.</li>
</ul>

	</div>

	<dl class="tree">
		<dd style="padding-left:0px">
			<a href="class-ArrayObject.html"><span>ArrayObject</span></a>
			
			 implements 
				<a href="class-IteratorAggregate.html"><span>IteratorAggregate</span></a>, 
			
				<a href="class-Traversable.html"><span>Traversable</span></a>, 
			
				<a href="class-ArrayAccess.html"><span>ArrayAccess</span></a>, 
			
				<a href="class-Serializable.html"><span>Serializable</span></a>, 
			
				<a href="class-Countable.html"><span>Countable</span></a>
			
			
		</dd>
		<dd style="padding-left:30px">
			<img src="resources/inherit.png" alt="Extended by" />
			<a href="class-CDocument.html"><span>CDocument</span></a>
			
			
			
		</dd>
		<dd style="padding-left:60px">
			<img src="resources/inherit.png" alt="Extended by" />
			<a href="class-CStatusDocument.html"><span>CStatusDocument</span></a>
			
			
			
		</dd>
		<dd style="padding-left:90px">
			<img src="resources/inherit.png" alt="Extended by" />
			<a href="class-CPersistentDocument.html"><span>CPersistentDocument</span></a>
			
			
			
		</dd>
		<dd style="padding-left:120px">
			<img src="resources/inherit.png" alt="Extended by" />
<b><span>CPersistentObject</span></b>			
			
			
		</dd>
	</dl>


	<div>
		<h4>Direct known subclasses</h4>
			<a href="class-CEdge.html">CEdge</a>, 
			<a href="class-CNode.html">CNode</a>, 
			<a href="class-CTag.html">CTag</a>, 
			<a href="class-CTerm.html">CTerm</a>
	</div>

	<div>
		<h4>Indirect known subclasses</h4>
			<a href="class-COntologyEdge.html">COntologyEdge</a>, 
			<a href="class-COntologyNode.html">COntologyNode</a>, 
			<a href="class-COntologyTag.html">COntologyTag</a>, 
			<a href="class-COntologyTerm.html">COntologyTerm</a>
	</div>





	<div class="info">
		
		
		
		<b>Package:</b> <a href="package-MyWrapper.html">MyWrapper</a>\<a href="package-MyWrapper.Persistence.html">Persistence</a><br />

				<b>Author:</b>
				Milko A. Škofič &lt;<a
href="mailto:m.skofic&#64;cgiar.org">m.skofic&#64;<!---->cgiar.org</a>&gt;<br />
		<b>Located at</b> <a href="source-class-CPersistentObject.html#36-851" title="Go to source code">CPersistentObject.php</a><br />
	</div>



	<table class="summary" id="methods">
	<caption>Methods summary</caption>
	<tr data-order="__toString" id="___toString">

		<td class="attributes"><code>
			 public 
			string
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#___toString">#</a>
		<code><a href="source-class-CPersistentObject.html#95-122" title="Go to source code">__toString</a>( )</code>

		<div class="description short">
			
<h4>Return object name</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Return object name</h4>

<p>This method should return the current object's name which should represent
the unique identifier of the object.</p>

<p>By default we return the value of the kTAG_GID offset, if this offset
is missing, the method will return <tt>NULL</tt>, which will result in a fatal
error. This behaviour is intentional, since in this case the returned value is
not correct and because this method cannot throw exceptions.</p>




				<h4>Returns</h4>
				<div class="list">
					<code>string</code><br>The connection name.<br />
				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="GID" id="_GID">

		<td class="attributes"><code>
			 public 
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_GID">#</a>
		<code><a href="source-class-CPersistentObject.html#138-176" title="Go to source code">GID</a>( <span>mixed <var>$theValue</var> = <span class="php-keyword1">NULL</span></span>, <span>boolean <var>$getOld</var> = <span class="php-keyword1">FALSE</span> </span> )</code>

		<div class="description short">
			
<h4>Manage global unique identifier</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Manage global unique identifier</h4>

<p>The <i>global unique identifier</i>, kTAG_GID, holds a string which
represents the object's unique identifier, this value is hashed or used as-is to
serve as the native unique identifier, kOFFSET_NID. The global
identifier is usually a computed value extracted from a series of offsets of the
object.</p>

<p>The method accepts a parameter which represents either the identifier or the
requested operation, depending on its value:</p>

<ul>
	<li><tt>NULL</tt>: Return the current value.</li>

	<li><tt>FALSE</tt>: Delete the current value.</li>

	<li><i>other</i>: Set the value with the provided parameter.</li>
</ul>

<p>The second parameter is a boolean which if <tt>TRUE</tt> will return the
<i>old</i> value when replacing containers; if <tt>FALSE</tt>, it will return
the currently set value.</p>

<p>Note that when the object has the <code><a href="class-CStatusDocument.html#__IsCommitted">CStatusDocument::_IsCommitted()</a></code> status this offset
will be locked and an exception will be raised.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theValue</var></dt>
					<dd><code>mixed</code><br>$theValue Native identifier or operation.</dd>
					<dt><var>$getOld</var></dt>
					<dd><code>boolean</code><br>$getOld <tt>TRUE</tt> get old value.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br><i>New</i> or <i>old</i> native container.<br />
				</div>


				<h4>See</h4>
				<div class="list">
						kTAG_GID<br />
				</div>
				<h4>Uses</h4>
				<div class="list">
						<code><code><a href="function-ManageOffset.html">ManageOffset()</a></code></code> <br />
				</div>


		</div>
		</div></td>
	</tr>
	<tr data-order="CLassName" id="_CLassName">

		<td class="attributes"><code>
			 public 
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_CLassName">#</a>
		<code><a href="source-class-CPersistentObject.html#183-221" title="Go to source code">CLassName</a>( <span>mixed <var>$theValue</var> = <span class="php-keyword1">NULL</span></span>, <span>boolean <var>$getOld</var> = <span class="php-keyword1">FALSE</span> </span> )</code>

		<div class="description short">
			
<h4>Manage global unique identifier</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Manage global unique identifier</h4>

<p>The <i>class name</i>, kTAG_CLASS, holds a string which is the class
name of the object that first stored the object in the container. This value
will be used by the static <code><a href="class-CPersistentObject.html#_NewObject">CPersistentObject::NewObject()</a></code> method to restore the object from
the container.</p>

<p>The method accepts a parameter which represents either the name or the
requested operation, depending on its value:</p>

<ul>
	<li><tt>NULL</tt>: Return the current value.</li>

	<li><tt>FALSE</tt>: Delete the current value.</li>

	<li><i>other</i>: Set the value with the provided parameter.</li>
</ul>

<p>The second parameter is a boolean which if <tt>TRUE</tt> will return the
<i>old</i> value when replacing containers; if <tt>FALSE</tt>, it will return
the currently set value.</p>

<p>Note that when the object has the <code><a href="class-CStatusDocument.html#__IsCommitted">CStatusDocument::_IsCommitted()</a></code> status this offset
will be locked and in many other classes this offset may not be writable.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theValue</var></dt>
					<dd><code>mixed</code><br>$theValue Persistent container or operation.</dd>
					<dt><var>$getOld</var></dt>
					<dd><code>boolean</code><br>$getOld <tt>TRUE</tt> get old value.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br><i>New</i> or <i>old</i> native container.<br />
				</div>


				<h4>See</h4>
				<div class="list">
						kTAG_CLASS<br />
				</div>
				<h4>Uses</h4>
				<div class="list">
						<code><code><a href="function-ManageOffset.html">ManageOffset()</a></code></code> <br />
				</div>


		</div>
		</div></td>
	</tr>
	<tr data-order="NewObject" id="_NewObject">

		<td class="attributes"><code>
			 public static
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_NewObject">#</a>
		<code><a href="source-class-CPersistentObject.html#237-312" title="Go to source code">NewObject</a>( <span><code><a href="class-CConnection.html">CConnection</a></code> <var>$theConnection</var></span>, <span>mixed <var>$theIdentifier</var></span> )</code>

		<div class="description short">
			
<h4>Instantiate an object from a container</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Instantiate an object from a container</h4>

<p>We override this method to handle the kTAG_CLASS offset: if found in
the retrieved object, it will be used to instantiate the correct class. If the
offset is missing, the method will instantiate the calling class.</p>

<p>The method expects two parameters:</p>

<ul>
	<li><tt>$theConnection</tt>: The container in which the object should be stored.
	This parameter should be a concrete instance of of <code><a href="class-CContainer.html">CContainer</a></code>, or a
	concrete instance of <code><a href="class-CServer.html">CServer</a></code> or <code><a href="class-CDatabase.html">CDatabase</a></code>, if the current class
	has implemented the container resolve interface with <code><a href="class-CPersistentDocument.html#_DefaultDatabase">CPersistentDocument::DefaultDatabase()</a></code> and
	<code><a href="class-CPersistentDocument.html#_DefaultContainer">CPersistentDocument::DefaultContainer()</a></code>.</li>

	<li><tt>$theIdentifier</tt>: The key of the object in the container, by default
	the kOFFSET_NID offset.</li>
</ul>

<p>If the object could not be located, the method will return <tt>NULL</tt>.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theConnection</var></dt>
					<dd><code><code><a href="class-CConnection.html">CConnection</a></code></code><br>$theConnection Server, database or container.</dd>
					<dt><var>$theIdentifier</var></dt>
					<dd><code>mixed</code><br>$theIdentifier Identifier.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br>The retrieved object.<br />
				</div>



				<h4>Overrides</h4>
				<div class="list"><code><a href="class-CPersistentDocument.html#_NewObject">CPersistentDocument::NewObject()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="DocumentObject" id="_DocumentObject">

		<td class="attributes"><code>
			 public static
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#_DocumentObject">#</a>
		<code><a href="source-class-CPersistentObject.html#319-371" title="Go to source code">DocumentObject</a>( <span>mixed <var>$theDocument</var></span> )</code>

		<div class="description short">
			
<h4>Instantiate an object from a document</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Instantiate an object from a document</h4>

<p>This method can be used to instantiate an object from an array. The method
will attempt to locate the class name, kTAG_CLASS, if found, it will
return an object of that class, if not, it will return the unchanged received
document.</p>

<p>If the class name was found, the resulting object will have its <code><a href="class-CStatusDocument.html#__IsCommitted">CStatusDocument::_IsCommitted()</a></code> status set, so provide only data received from database
queries.</p>

<p>The method accepts arrays and ArrayObjects, any other type will raise an
exception.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theDocument</var></dt>
					<dd><code>mixed</code><br>$theDocument Persistent object data.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br>The document or an object.<br />
				</div>




		</div>
		</div></td>
	</tr>
	<tr data-order="_id" id="__id">

		<td class="attributes"><code>
			 public static
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__id">#</a>
		<code><a href="source-class-CPersistentObject.html#387-418" title="Go to source code">_id</a>( <span>string <var>$theIdentifier</var> = <span class="php-keyword1">NULL</span></span>, <span><code><a href="class-CConnection.html">CConnection</a></code> <var>$theConnection</var> = <span class="php-keyword1">NULL</span> </span> )</code>

		<div class="description short">
			
<h4>Generate the object's native unique identifier</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Generate the object's native unique identifier</h4>

<p>This method is used to generate the object's <i>native unique identifier</i>,
kOFFSET_NID, from the string representing the object's <i>global unique
identifier</i>, kTAG_GID.</p>

<p>The first parameter of the method is a string, the second parameter can be a
server or database which can be resolved into a container, or the container
itself. This parameter can be used to process the first one: since the resulting
value must be stored in a container, it should be the duty of the container
itself to convert, for instance binary strings, to a suitable value.</p>

<p>If the method receives <tt>NULL</tt> in the first parameter, this means that
the object does not use the global identifier and it is the duty of the
container to set the object's primary key, such as with autonumbers in SQL or
missing <tt>_id</tt> in Mongo. In that case this method should not be called,
see the <code><a href="class-CPersistentDocument.html#__Precommit">CPersistentDocument::_Precommit()</a></code> method to see where it is used.</p>

<p>In this class we do not process the identifier, so we simply return it.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theIdentifier</var></dt>
					<dd><code>string</code><br>$theIdentifier Global unique identifier.</dd>
					<dt><var>$theConnection</var></dt>
					<dd><code><code><a href="class-CConnection.html">CConnection</a></code></code><br>$theConnection Server, database or container.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br>The object's native unique identifier.<br />
				</div>


				<h4>Used by</h4>
				<div class="list">
						<code><code><a href="class-CPersistentObject.html#__PrecommitIdentify">CPersistentObject::_PrecommitIdentify()</a></code></code> <br />
				</div>


		</div>
		</div></td>
	</tr>
	<tr data-order="_index" id="__index">

		<td class="attributes"><code>
			 protected 
			string|null
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__index">#</a>
		<code><a href="source-class-CPersistentObject.html#434-478" title="Go to source code">_index</a>( <span><code><a href="class-CConnection.html">CConnection</a></code> <var>$theConnection</var></span>, <span>bitfield <var>$theModifiers</var></span> )</code>

		<div class="description short">
			
<h4>Return the object's global unique identifier</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Return the object's global unique identifier</h4>

<p>This method should return the object's global unique identifier, this value
is represented by a string which is generally extracted from selected attributes
of the object and constitutes the unique key of the object.</p>

<p>This string is stored in the kTAG_GID offset of the object and it is
processed by the static <code><a href="class-CPersistentObject.html#__id">CPersistentObject::_id()</a></code> method to generate the object's native
unique identifier, which is the native object's primary key stored in the kOFFSET_NID offset.</p>

<p>This method is called by the <code><a href="class-CPersistentDocument.html#__Precommit">CPersistentDocument::_Precommit()</a></code> method, to fill the kTAG_GID offset and the resulting value is fed to the <code><a href="class-CPersistentObject.html#__id">CPersistentObject::_id()</a></code> method to
obtain the value that will be stored in the kOFFSET_NID offset. The
inherited Precommit() method asserts whether the object <code><a href="class-CStatusDocument.html#__IsInited">CStatusDocument::_IsInited()</a></code>, before calling the local <code><a href="class-CPersistentDocument.html#__Precommit">CPersistentDocument::_Precommit()</a></code> method, this to
ensure that this method can safely use the object's attributes to generate the
identifier. If you intend to use this method in other places, you should check
if the object is initialised.</p>

<p>If the object does not feature or use the global identifier, this method
should return <tt>NULL</tt>, this will be an indication that the native
identifier is filled in another place, or that the identifier is filled by the
container.</p>

<p>The method accepts the same parameters as the Precommit() method
which passes them to this one. The first one should resolve into the container
in which the object will be saved, this parameter can be useful when committing
embedded objects which reside in different containers. The second parameter
represents the operation options which can be useful to determine whether the
object is being inserted, replaced or updated.</p>

<p>In this class we do not have attributes that can be used to generate an
identifier, so we let the container set the identifier, and return
<tt>NULL</tt>.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theConnection</var></dt>
					<dd><code><code><a href="class-CConnection.html">CConnection</a></code></code><br>$theConnection Server, database or container.</dd>
					<dt><var>$theModifiers</var></dt>
					<dd><code>bitfield</code><br>$theModifiers Commit options.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>string|null</code><br>The object's global unique identifier.<br />
				</div>


				<h4>Used by</h4>
				<div class="list">
						<code><code><a href="class-CPersistentObject.html#__PrecommitIdentify">CPersistentObject::_PrecommitIdentify()</a></code></code> <br />
				</div>


		</div>
		</div></td>
	</tr>
	<tr data-order="_Preset" id="__Preset">

		<td class="attributes"><code>
			 protected 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__Preset">#</a>
		<code><a href="source-class-CPersistentObject.html#494-530" title="Go to source code">_Preset</a>( <span>reference <var>&amp; $theOffset</var></span>, <span>reference <var>&amp; $theValue</var></span> )</code>

		<div class="description short">
			
<h4>Handle offset before setting it</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Handle offset before setting it</h4>

<p>In this class we prevent the modification of offsets that concur in the
generation of the object's identifier if the object has its <code><a href="class-CStatusDocument.html#__IsCommitted">CStatusDocument::_IsCommitted()</a></code> status set. This is because referenced objects must not change
identifier.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theOffset</var></dt>
					<dd><code>reference</code><br>&amp;$theOffset Offset.</dd>
					<dt><var>$theValue</var></dt>
					<dd><code>reference</code><br>&amp;$theValue Value to set at offset.</dd>
				</dl></div>


				<h4>Throws</h4>
				<div class="list">
					<code><code><a href="class-Exception.html">Exception</a></code></code><br />
				</div>

				<h4>See</h4>
				<div class="list">
						kOFFSET_NID kTAG_GID<br />
				</div>
				<h4>Uses</h4>
				<div class="list">
						<code><code><a href="class-CStatusDocument.html#__IsCommitted">CStatusDocument::_IsCommitted()</a></code></code> <br />
				</div>

				<h4>Overrides</h4>
				<div class="list"><code><a href="class-CStatusDocument.html#__Preset">CStatusDocument::_Preset()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="_Preunset" id="__Preunset">

		<td class="attributes"><code>
			 protected 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__Preunset">#</a>
		<code><a href="source-class-CPersistentObject.html#537-572" title="Go to source code">_Preunset</a>( <span>reference <var>&amp; $theOffset</var></span> )</code>

		<div class="description short">
			
<h4>Handle offset before unsetting it</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Handle offset before unsetting it</h4>

<p>In this class we prevent the modification of offsets that concur in the
generation of the object's identifier if the object has its <code><a href="class-CStatusDocument.html#__IsCommitted">CStatusDocument::_IsCommitted()</a></code> status set. This is because referenced objects must not change
identifier.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theOffset</var></dt>
					<dd><code>reference</code><br>&amp;$theOffset Offset.</dd>
				</dl></div>


				<h4>Throws</h4>
				<div class="list">
					<code><code><a href="class-Exception.html">Exception</a></code></code><br />
				</div>

				<h4>See</h4>
				<div class="list">
						kOFFSET_NID kTAG_GID<br />
				</div>
				<h4>Uses</h4>
				<div class="list">
						<code><code><a href="class-CStatusDocument.html#__IsCommitted">CStatusDocument::_IsCommitted()</a></code></code> <br />
				</div>

				<h4>Overrides</h4>
				<div class="list"><code><a href="class-CStatusDocument.html#__Preunset">CStatusDocument::_Preunset()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="_PrecommitValidate" id="__PrecommitValidate">

		<td class="attributes"><code>
			 protected 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__PrecommitValidate">#</a>
		<code><a href="source-class-CPersistentObject.html#588-626" title="Go to source code">_PrecommitValidate</a>( <span>reference <var>&amp; $theConnection</var></span>, <span>reference <var>&amp; $theModifiers</var></span> )</code>

		<div class="description short">
			
<h4>Validate the object before committing</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Validate the object before committing</h4>

<p>In this class we check if the current object has its native identifier,
kOFFSET_NID, if the operation involves updating.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theConnection</var></dt>
					<dd><code>reference</code><br>&amp;$theConnection Server, database or container.</dd>
					<dt><var>$theModifiers</var></dt>
					<dd><code>reference</code><br>&amp;$theModifiers Commit options.</dd>
				</dl></div>


				<h4>Throws</h4>
				<div class="list">
					<code><code><a href="class-Exception.html">Exception</a></code></code><br />
				</div>

				<h4>See</h4>
				<div class="list">
						kFLAG_PERSIST_MASK kFLAG_PERSIST_UPDATE kOFFSET_NID<br />
				</div>

				<h4>Overrides</h4>
				<div class="list"><code><a href="class-CPersistentDocument.html#__PrecommitValidate">CPersistentDocument::_PrecommitValidate()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="_PrecommitRelated" id="__PrecommitRelated">

		<td class="attributes"><code>
			 protected 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__PrecommitRelated">#</a>
		<code><a href="source-class-CPersistentObject.html#633-663" title="Go to source code">_PrecommitRelated</a>( <span>reference <var>&amp; $theConnection</var></span>, <span>reference <var>&amp; $theModifiers</var></span> )</code>

		<div class="description short">
			
<h4>Handle embedded or related objects before committing</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Handle embedded or related objects before committing</h4>

<p>In this class we have no related objects, but we use this method to set
default values, such as the class name in kTAG_CLASS when inserting,
replacing or updating.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theConnection</var></dt>
					<dd><code>reference</code><br>&amp;$theConnection Server, database or container.</dd>
					<dt><var>$theModifiers</var></dt>
					<dd><code>reference</code><br>&amp;$theModifiers Commit options.</dd>
				</dl></div>



				<h4>See</h4>
				<div class="list">
						kTAG_CLASS<br />
						kFLAG_PERSIST_INSERT kFLAG_PERSIST_REPLACE kFLAG_PERSIST_UPDATE<br />
				</div>

				<h4>Overrides</h4>
				<div class="list"><code><a href="class-CPersistentDocument.html#__PrecommitRelated">CPersistentDocument::_PrecommitRelated()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="_PrecommitIdentify" id="__PrecommitIdentify">

		<td class="attributes"><code>
			 protected 
			
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__PrecommitIdentify">#</a>
		<code><a href="source-class-CPersistentObject.html#670-749" title="Go to source code">_PrecommitIdentify</a>( <span>reference <var>&amp; $theConnection</var></span>, <span>reference <var>&amp; $theModifiers</var></span> )</code>

		<div class="description short">
			
<h4>Determine the identifiers before committing</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Determine the identifiers before committing</h4>

<p>In this class this method is called only if the operation involves inserting
or replacing.</p>

<p>If the kTAG_GID offset is missing, we call the <code><a href="class-CPersistentObject.html#__index">CPersistentObject::_index()</a></code>
method: if the result of that method is not <tt>NULL</tt>, we use it to set the
kTAG_GID offset value, this only if the operation involves inserting or
replacing.</p>

<p>If the kOFFSET_NID offset is missing, we check if the kTAG_GID offset was set: in that case we use its value to feed the <code><a href="class-CPersistentObject.html#__id">CPersistentObject::_id()</a></code> method and the result is set in the kOFFSET_NID offset.</p>

<p>This workflow implies that only if the <code><a href="class-CPersistentObject.html#__index">CPersistentObject::_index()</a></code> method returns a non
<tt>NULL</tt> value, the kTAG_GID offset will be set in this method, and
that if the kTAG_GID offset is missing the native identifier will not be
touched.</p>

<p>Note that this is the only place in which the <code><a href="class-CPersistentObject.html#__index">CPersistentObject::_index()</a></code> method is
called.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theConnection</var></dt>
					<dd><code>reference</code><br>&amp;$theConnection Server, database or container.</dd>
					<dt><var>$theModifiers</var></dt>
					<dd><code>reference</code><br>&amp;$theModifiers Commit options.</dd>
				</dl></div>



				<h4>See</h4>
				<div class="list">
						kTAG_GID kOFFSET_NID<br />
						kFLAG_PERSIST_INSERT kFLAG_PERSIST_REPLACE<br />
				</div>
				<h4>Uses</h4>
				<div class="list">
						<code><code><a href="class-CPersistentObject.html#__id">CPersistentObject::_id()</a></code></code> <br />
						<code><code><a href="class-CPersistentObject.html#__index">CPersistentObject::_index()</a></code></code> <br />
						<code><code><a href="class-CPersistentDocument.html#_ResolveContainer">CPersistentDocument::ResolveContainer()</a></code></code> <br />
				</div>

				<h4>Overrides</h4>
				<div class="list"><code><a href="class-CPersistentDocument.html#__PrecommitIdentify">CPersistentDocument::_PrecommitIdentify()</a></code></div>

		</div>
		</div></td>
	</tr>
	<tr data-order="_AssertClass" id="__AssertClass">

		<td class="attributes"><code>
			 protected 
			mixed
			
			</code>
		</td>

		<td class="name"><div>
		<a class="anchor" href="#__AssertClass">#</a>
		<code><a href="source-class-CPersistentObject.html#765-847" title="Go to source code">_AssertClass</a>( <span>reference <var>&amp; $theValue</var></span>, <span>string <var>$theBaseClass</var></span>, <span>string <var>$theDerivedClass</var> = <span class="php-keyword1">NULL</span></span>, <span>boolean <var>$doThrow</var> = <span class="php-keyword1">FALSE</span> </span> )</code>

		<div class="description short">
			
<h4>Ensure the provided object is of the correct class</h4>

		</div>

		<div class="description detailed hidden">
			
<h4>Ensure the provided object is of the correct class</h4>

<p>This method can be used to check whether the provided value is of the correct
class. the method will first check if the value corresponds to a base class,
<tt>$theBaseClass</tt>, it will then check if the object is an instance of a
derived class, <tt>$theDerivedClass</tt>.</p>

<p>If the value is not an object of the base class, the method will return
<tt>NULL</tt>, if the object is an instance of both the base and derived
classes, the method will return <tt>TRUE</tt>; if the object is not an instance
of the derived class: if the second parameter, <tt>$doThrow</tt>, is
<tt>TRUE</tt>, the method will raise an exception, if not, it will return
<tt>FALSE</tt>.</p>

<p>If you omit the derived class, the test will return <tt>TRUE</tt>, if the
value is an instance of the base class.</p>



				<h4>Parameters</h4>
				<div class="list"><dl>
					<dt><var>$theValue</var></dt>
					<dd><code>reference</code><br>$theValue Value to assert.</dd>
					<dt><var>$theBaseClass</var></dt>
					<dd><code>string</code><br>$theBaseClass Base class to test.</dd>
					<dt><var>$theDerivedClass</var></dt>
					<dd><code>string</code><br>$theDerivedClass Derived class to test.</dd>
					<dt><var>$doThrow</var></dt>
					<dd><code>boolean</code><br>$doThrow If <tt>TRUE</tt> raise exception.</dd>
				</dl></div>

				<h4>Returns</h4>
				<div class="list">
					<code>mixed</code><br><tt>TRUE</tt> correct object,; <tt>NULL</tt> bot an object; <tt>FALSE</tt> not
an object.<br />
				</div>

				<h4>Throws</h4>
				<div class="list">
					<code><code><a href="class-Exception.html">Exception</a></code></code><br />
				</div>



		</div>
		</div></td>
	</tr>
	</table>

	<table class="summary inherited">
	<caption>Methods inherited from <a href="class-CPersistentDocument.html#methods">CPersistentDocument</a></caption>
	<tr>
		<td><code>
			<a href="class-CPersistentDocument.html#_DefaultContainer">DefaultContainer()</a>, 
			<a href="class-CPersistentDocument.html#_DefaultDatabase">DefaultDatabase()</a>, 
			<a href="class-CPersistentDocument.html#_Delete">Delete()</a>, 
			<a href="class-CPersistentDocument.html#_Insert">Insert()</a>, 
			<a href="class-CPersistentDocument.html#_NID">NID()</a>, 
			<a href="class-CPersistentDocument.html#_Replace">Replace()</a>, 
			<a href="class-CPersistentDocument.html#_ResolveClassContainer">ResolveClassContainer()</a>, 
			<a href="class-CPersistentDocument.html#_ResolveContainer">ResolveContainer()</a>, 
			<a href="class-CPersistentDocument.html#_Restore">Restore()</a>, 
			<a href="class-CPersistentDocument.html#_Update">Update()</a>, 
			<a href="class-CPersistentDocument.html#__Postcommit">_Postcommit()</a>, 
			<a href="class-CPersistentDocument.html#__PostcommitCleanup">_PostcommitCleanup()</a>, 
			<a href="class-CPersistentDocument.html#__PostcommitRelated">_PostcommitRelated()</a>, 
			<a href="class-CPersistentDocument.html#__PostcommitStatus">_PostcommitStatus()</a>, 
			<a href="class-CPersistentDocument.html#__Precommit">_Precommit()</a>
		</code></td>
	</tr>
	</table>
	<table class="summary inherited">
	<caption>Methods inherited from <a href="class-CStatusDocument.html#methods">CStatusDocument</a></caption>
	<tr>
		<td><code>
			<a href="class-CStatusDocument.html#__IsCommitted">_IsCommitted()</a>, 
			<a href="class-CStatusDocument.html#__IsDirty">_IsDirty()</a>, 
			<a href="class-CStatusDocument.html#__IsEncoded">_IsEncoded()</a>, 
			<a href="class-CStatusDocument.html#__IsInited">_IsInited()</a>, 
			<a href="class-CStatusDocument.html#__Postset">_Postset()</a>, 
			<a href="class-CStatusDocument.html#__Postunset">_Postunset()</a>, 
			<a href="class-CStatusDocument.html#__Ready">_Ready()</a>, 
			<a href="class-CStatusDocument.html#___construct">__construct()</a>, 
			<a href="class-CStatusDocument.html#_offsetSet">offsetSet()</a>, 
			<a href="class-CStatusDocument.html#_offsetUnset">offsetUnset()</a>
		</code></td>
	</tr>
	</table>
	<table class="summary inherited">
	<caption>Methods inherited from <a href="class-CDocument.html#methods">CDocument</a></caption>
	<tr>
		<td><code>
			<a href="class-CDocument.html#_array_keys">array_keys()</a>, 
			<a href="class-CDocument.html#_array_values">array_values()</a>, 
			<a href="class-CDocument.html#_offsetGet">offsetGet()</a>
		</code></td>
	</tr>
	</table>
	<table class="summary inherited">
	<caption>Methods inherited from <a href="class-ArrayObject.html#methods">ArrayObject</a></caption>
	<tr>
		<td><code>
			<a href="class-ArrayObject.html#_append">append()</a>, 
			<a href="class-ArrayObject.html#_asort">asort()</a>, 
			<a href="class-ArrayObject.html#_count">count()</a>, 
			<a href="class-ArrayObject.html#_exchangeArray">exchangeArray()</a>, 
			<a href="class-ArrayObject.html#_getArrayCopy">getArrayCopy()</a>, 
			<a href="class-ArrayObject.html#_getFlags">getFlags()</a>, 
			<a href="class-ArrayObject.html#_getIterator">getIterator()</a>, 
			<a href="class-ArrayObject.html#_getIteratorClass">getIteratorClass()</a>, 
			<a href="class-ArrayObject.html#_ksort">ksort()</a>, 
			<a href="class-ArrayObject.html#_natcasesort">natcasesort()</a>, 
			<a href="class-ArrayObject.html#_natsort">natsort()</a>, 
			<a href="class-ArrayObject.html#_offsetExists">offsetExists()</a>, 
			<a href="class-ArrayObject.html#_serialize">serialize()</a>, 
			<a href="class-ArrayObject.html#_setFlags">setFlags()</a>, 
			<a href="class-ArrayObject.html#_setIteratorClass">setIteratorClass()</a>, 
			<a href="class-ArrayObject.html#_uasort">uasort()</a>, 
			<a href="class-ArrayObject.html#_uksort">uksort()</a>, 
			<a href="class-ArrayObject.html#_unserialize">unserialize()</a>
		</code></td>
	</tr>
	</table>








	<table class="summary inherited">
	<caption>Constants inherited from <a href="class-ArrayObject.html#constants">ArrayObject</a></caption>
	<tr>
		<td><code>
			<a href="class-ArrayObject.html#ARRAY_AS_PROPS"><b>ARRAY_AS_PROPS</b></a>, 
			<a href="class-ArrayObject.html#STD_PROP_LIST"><b>STD_PROP_LIST</b></a>
		</code></td>
	</tr>
	</table>




	<table class="summary inherited">
	<caption>Properties inherited from <a href="class-CStatusDocument.html#properties">CStatusDocument</a></caption>
	<tr>
		<td><code>
			<a href="class-CStatusDocument.html#$mStatus"><var>$mStatus</var></a>
		</code></td>
	</tr>
	</table>





</div>

	<div id="footer">
		MyWrapper Reference Documentation API documentation generated by <a href="http://apigen.org">ApiGen 2.8.0</a>
	</div>
</div>
</div>
</body>
</html>
